{
  "enabled": true,
  "name": "Auto-Detect Security Vulnerabilities",
  "description": "Automatically scans edited files for security vulnerabilities including exposed credentials, weak encryption, injection attacks, LGPD/HIPAA violations, and AWS misconfigurations. Provides immediate fixes and security recommendations.",
  "version": "1",
  "when": {
    "type": "fileEdited",
    "patterns": [
      "*.js",
      "*.ts",
      "*.jsx",
      "*.tsx",
      "*.py",
      "*.java",
      "*.php",
      "*.rb",
      "*.go",
      "*.rs",
      "*.cpp",
      "*.c",
      "*.cs",
      "*.sql",
      "*.yaml",
      "*.yml",
      "*.json",
      "*.env",
      "*.config",
      "*.tf",
      "*.tfvars",
      "*.dockerfile",
      "Dockerfile",
      "*.sh",
      "*.bash"
    ]
  },
  "then": {
    "type": "askAgent",
    "prompt": "ðŸ”’ SECURITY SCAN: Analyze the edited file for these critical vulnerabilities:\n\n**CREDENTIALS & SECRETS:**\n- Environment variables exposed in code\n- Hardcoded passwords, API keys, tokens\n- AWS, GitHub, Bedrock, Stripe credentials\n- Database connection strings with credentials\n- JWT secrets, encryption keys\n\n**PERSONAL DATA (LGPD/HIPAA):**\n- CPF, email, phone numbers in logs\n- Sensitive personal data in public APIs\n- Unencrypted health/medical data\n- Missing data anonymization\n\n**INJECTION ATTACKS:**\n- SQL injection vulnerabilities\n- Command injection risks\n- Use of eval(), exec(), dangerous functions\n- Unsanitized user input\n\n**WEAK SECURITY:**\n- MD5, SHA1, weak encryption\n- JWT without expiration\n- Missing input validation\n- Weak password policies\n\n**AWS/CLOUD MISCONFIG:**\n- Public S3 buckets\n- Overly permissive IAM (*:*)\n- Open security groups (0.0.0.0/0)\n- Secrets not in Secrets Manager\n- Unencrypted data at rest/transit\n\n**WEB SECURITY:**\n- Open CORS policies\n- Missing security headers\n- HTTP instead of HTTPS\n- XSS vulnerabilities\n\nFor each vulnerability found:\n1. ðŸš¨ Highlight the exact line/code\n2. ðŸ”§ Provide immediate fix\n3. ðŸ“‹ Explain the security risk\n4. âœ… Suggest best practices\n\nIf no vulnerabilities found, confirm the file is secure."
  },
  "workspaceFolderName": "kiro",
  "shortName": "security-vulnerability-scanner"
}